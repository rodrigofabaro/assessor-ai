# --- OpenAI keys (keep in .env only, never commit real values) ---
OPENAI_API_KEY=
OPENAI_ADMIN_KEY=
OPENAI_ADMIN_API_KEY=
OPENAI_ADMIN=
OPENAI_ORG_ID=

# --- OpenAI model defaults ---
OPENAI_MODEL=gpt-4o-mini
OPENAI_EQUATION_MODEL=gpt-4o-mini
OPENAI_OCR_MODEL=gpt-4o-mini

# --- Hybrid AI provider routing ---
# Modes: openai | local | hybrid
AI_LOCAL_ENABLED=true
AI_PROVIDER_MODE=hybrid
AI_PROVIDER_CLEANUP_MODE=local
AI_PROVIDER_OCR_MODE=hybrid
AI_PROVIDER_EQUATION_MODE=hybrid
AI_PROVIDER_GRAPH_MODE=hybrid

# --- Local AI server (Ollama-compatible) ---
AI_LOCAL_BASE_URL=http://127.0.0.1:11434
AI_LOCAL_TEXT_MODEL=qwen2.5:7b-instruct
AI_LOCAL_VISION_MODEL=llava:7b
AI_LOCAL_CLEANUP_MODEL=qwen2.5:7b-instruct
AI_LOCAL_OCR_MODEL=llava:7b
AI_LOCAL_EQUATION_MODEL=llava:7b
AI_LOCAL_GRAPH_MODEL=llava:7b

# --- Local provider timeouts (ms) ---
AI_LOCAL_TIMEOUT_MS=30000
AI_LOCAL_CLEANUP_TIMEOUT_MS=25000
AI_LOCAL_OCR_TIMEOUT_MS=35000
AI_LOCAL_EQUATION_TIMEOUT_MS=25000
AI_LOCAL_GRAPH_TIMEOUT_MS=30000
AI_LOCAL_BRIEF_STRUCTURE_TIMEOUT_MS=35000

# --- Extraction quality recovery ---
AI_BRIEF_STRUCTURE_RECOVERY=true
OPENAI_BRIEF_STRUCTURE_MODEL=gpt-4o-mini
OPENAI_BRIEF_STRUCTURE_MAX_OUTPUT_TOKENS=2200
OPENAI_BRIEF_STRUCTURE_TIMEOUT_MS=45000
OPENAI_BRIEF_STRUCTURE_RETRIES=1

# --- OpenAI fallback controls ---
OPENAI_GRADE_INPUT_CHAR_LIMIT=18000
OPENAI_GRADE_MAX_OUTPUT_TOKENS=1100
OPENAI_GRADE_TIMEOUT_MS=60000
OPENAI_GRADE_RETRIES=2
OPENAI_GRADE_PAGE_SAMPLE_COUNT=4
OPENAI_GRADE_PAGE_SAMPLE_CHAR_LIMIT=1600

OPENAI_OCR_MAX_OUTPUT_TOKENS=1200
OPENAI_OCR_TIMEOUT_MS=45000
OPENAI_OCR_RETRIES=2

OPENAI_CLEANUP_MAX_OUTPUT_TOKENS=900
OPENAI_CLEANUP_TIMEOUT_MS=30000
OPENAI_CLEANUP_RETRIES=1

OPENAI_EQ_TIMEOUT_MS=25000
OPENAI_EQ_RETRIES=1
OPENAI_GRAPH_TIMEOUT_MS=30000
OPENAI_GRAPH_RETRIES=1

# --- Grading confidence policy ---
GRADE_MODALITY_MISSING_CONFIDENCE_CAP=0.65
# Global contradiction guard: downgrade ACHIEVED when rationale language indicates evidence gaps.
GRADE_GLOBAL_CONTRADICTION_GUARD_ENABLED=true

# --- App release label ---
NEXT_PUBLIC_APP_VERSION=0.4-stable-rc1
NEXT_PUBLIC_RELEASE_LABEL=stable candidate

# --- Submission extraction mode (Phase 1 simplified grading) ---
# true: extract only cover pages + metadata; false: full body extraction
SUBMISSION_EXTRACT_COVER_ONLY=true
# Number of pages to inspect for cover metadata (1..3)
SUBMISSION_EXTRACT_COVER_PAGE_LIMIT=2
# Auto-start grading after extraction+triage when submission is link-complete
SUBMISSION_AUTO_GRADE_ON_EXTRACT=true
# Re-run grading when cover metadata is manually updated (refreshes personalized feedback)
SUBMISSION_AUTO_REGRADE_ON_COVER_UPDATE=true
